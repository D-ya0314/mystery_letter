<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ãƒã‚¸ã‚·ãƒ£ãƒ³ã‹ã‚‰ã®æ‰‹ç´™</title>
    <meta name="description" content="ãƒã‚¸ã‚·ãƒ£ãƒ³ã‹ã‚‰ã®æ‰‹ç´™" />
    <meta name="format-detection" content="telephone=no" />

    <!-- favicon/web-clip-icon -->
    <link rel="icon" href="favicon.ico" type="image/ico" />
    <link rel="icon" href="favicon.png" type="image/png" />
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="webclip.png" />

    <!-- ogpå…±æœ‰æ™‚ã®è¡¨ç¤º -->
    <meta property="og:site_name" content="D-yaã®WEBãƒšãƒ¼ã‚¸" />
    <meta property="og:url" content="http://127.0.0.1:5500/src/index.html" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="D-yaã®WEBãƒšãƒ¼ã‚¸" />
    <meta property="og:description" content="D-yaã®WEBãƒšãƒ¼ã‚¸" />
    <meta property="og:image" content="URL" />
    <meta property="og:locale" content="ja_JP" />

    <meta property="fb:app_id" content="AppID" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@twitter_id" />
    <meta name="twitter:description" content="D-yaã®WEBãƒšãƒ¼ã‚¸" />
    <meta name="twitter:image:src" content="URL" />

    <!-- google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- css -->
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/style.css" />

    <!-- js -->
    <script src="js/main.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>

    <!-- audio -->
    <audio id="seCut" src="audio/break-heart.mp3" preload="auto"></audio>
  </head>
  <body class="js_body">
    <div class="letter">
      <p class="js_hint">ãƒŸã‚¹å›æ•°ï¼š<span id="mistakeCountDisplay">0</span></p>

      <p class="js_hint">Q4å›ç­”ï¼š<span id="q4AnswerValueDisplay">0</span></p>

      <h1 class="m_title">
        <span
          class="js_magician"
          id="magician"
          ondrop="dropCard(event)"
          ondragover="allowDrop(event)"
          >â€œãƒã‚¸ã‚·ãƒ£ãƒ³â€</span
        >ã‹ã‚‰ã®ä¸æ€è­°ãªæ‰‹ç´™
      </h1>
      <p>
        ç§ã¯ã“ã®æ‰‹ç´™ã«ä½ã‚“ã§ã„ã‚‹è¬ã®æ¡ˆå†…äºº...<br />ä¸‹ã®ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦ã“ã®æ‰‹ç´™ã®è¬ã‚’è§£ã„ã¦ã¿ã‚‹ãŒã‚ˆã„ã€‚
      </p>
      <section class="l_question">
        <p class="m_question_p">Q1.â—‹â—‹â—‹ã«ã¯ä½•ãŒå…¥ã‚‹ã‹ãªï¼Ÿ</p>
        <div class="l_q1_content">
          <div class="l_question_img-box">
            <img
              class="m_qurstion_img"
              src="img/bee.png"
              alt=""
              width="368"
              height="400"
            />
          </div>
          <p class="m_q1_p">â†’</p>
          <p class="m_q1_p">ãƒ€ã‚¤ãƒ¤</p>
        </div>
        <div class="l_q1_content">
          <div class="l_question_img-box">
            <img
              class="m_qurstion_img"
              src="img/gun.png"
              alt=""
              width="400"
              height="400"
            />
          </div>
          <p class="m_q1_p">â†’</p>
          <p class="m_q1_p">â—‹â—‹â—‹</p>
        </div>
        <input type="text" id="q1-answer" placeholder="ã“ã“ã«ç­”ãˆã‚’å…¥åŠ›" />
        <button onclick="q1CheckAnswer()">ç­”ãˆã‚‹</button>
        <p id="q1-result"></p>
      </section>
      <script>
        function q1CheckAnswer() {
          const input = document
            .getElementById("q1-answer")
            .value.trim()
            .toLowerCase();
          const result = document.getElementById("q1-result");

          if (input === "ã‚¯ãƒ©ãƒ–" || input === "ãã‚‰ã¶") {
            result.textContent = "æ­£è§£ã â€¦ã€‚æ¬¡ã®è¬ã«é€²ã‚ã€‚";
            // location.href = "next.html"; // ãƒšãƒ¼ã‚¸ç§»å‹•ã•ã›ãŸã„ãªã‚‰ã“ã‚Œ
          } else {
            result.textContent = "é•ã†ã‚ˆã†ã â€¦ã€‚ã‚‚ã†ä¸€åº¦è©¦ã›ã€‚";
            /* ğŸ”Šå¤±æ‹éŸ³å†ç”Ÿ */
            brakeHeart();
            /* ãƒŸã‚¹ã‚«ã‚¦ãƒ³ãƒˆ */
            addMistake();
          }
        }
      </script>
      <section class="l_question">
        <p class="m_question_p">Q2.æ‰‹æœ­ã«æ½œã‚€è¨€è‘‰â€¦å›ã«èª­ã¿è§£ã‘ã‚‹ã‹ï¼Ÿ<br />ã€11ã€€1ã€€cã€€13ã€</p>
        <input type="text" id="q2-answer" placeholder="ã“ã“ã«ç­”ãˆã‚’å…¥åŠ›" />
        <button onclick="q2CheckAnswer()">ç­”ãˆã‚‹</button>
        <p id="q2-result"></p>
      </section>

      <script>
        function q2CheckAnswer() {
          const input = document
            .getElementById("q2-answer")
            .value.trim()
            .toLowerCase();
          const result = document.getElementById("q2-result");

          if (input === "jack") {
            result.textContent =
              "æ­£è§£ã ...ã€‚å›ã‚‚ã¾ãŸã€â€œå½¼â€ã¨åŒã˜æœ­ã‚’æ¡ã£ãŸã‚ˆã†ã ãªâ€¦ã€‚";
          } else {
            result.textContent =
              "ç­”ãˆãŒé•ã†ã‚ˆã†ã â€¦ã‚‚ã†ä¸€åº¦æ‰‹æœ­ã‚’è¦‹ç›´ã™ãŒã„ã„ã€‚";
            /* ğŸ”Šå¤±æ‹éŸ³å†ç”Ÿ */
            brakeHeart();
            /* ãƒŸã‚¹ã‚«ã‚¦ãƒ³ãƒˆ */
            addMistake();
          }
        }
      </script>
      <section class="l_question">
        <p class="m_question_p">Q3.å›ã«ã¯æ¬¡ã®â™¡ã‚’åˆ‡ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ãªï¼Ÿ</p>
        <div class="drop-area">
          <div
            class="heart-slot"
            id="heart0"
            ondrop="dropHeart(event, 0)"
            ondragover="allowDrop(event)"
          >
            <div class="heart-content">â™¡</div>
          </div>
          <div
            class="heart-slot"
            id="heart1"
            ondrop="dropHeart(event, 1)"
            ondragover="allowDrop(event)"
          >
            <div class="heart-content">â™¡</div>
          </div>
          <div
            class="heart-slot"
            id="heart2"
            ondrop="dropHeart(event, 2)"
            ondragover="allowDrop(event)"
          >
            <div class="heart-content">â™¡</div>
          </div>
        </div>
        <p id="q3-result"></p>
      </section>
      <section class="l_question">
        <p class="m_question_p">
          Q4.å®Ÿã¯ã“ã®æ‰‹ç´™ã¯ãƒ©ãƒ–ãƒ¬ã‚¿ãƒ¼ã€ã€ã€ãªã‚“ã¦ã­ã€‚ã¨ã“ã‚ã§å¤±æ‹ã—ãŸå›æ•°ã¯ä½•å›ãªã‚“ã ã„ï¼Ÿ<br />ãã‚Œã«ã—ã¦ã‚‚å¤±æ‹ã¨ã¯æ‚²ã—ã„ã“ã¨ã ã€‚æ™‚ã«ã¯ãƒªã‚»ãƒƒãƒˆâ†»ã—ã¦ç›®ã®å‰ã®ã‚‚ã®ã«è€³ã‚’ã‹ãŸã‚€ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„...
        </p>
        <input
          type="number"
          id="q4-answer"
          inputmode="numeric"
          pattern="[0-9]*"
          oninput="this.value = this.value.replace(/[^0-9]/g, '')"
          placeholder="æ•°å­—ã‚’å…¥åŠ›"
        />
        <p style="display: inline;">å›</p>
        <button onclick="q4CheckAnswer()">ç­”ãˆã‚‹</button>
        <p id="q4-result"></p>
      </section>
      <section class="l_question js_final-question">
        <p class="final-question m_question_p">Q1ã®Q2ã‚’Q4å›Q3ã›ã‚ˆã€‚</p>
        <p class="js_hint">ã‚¯ãƒªãƒƒã‚¯ã‚«ã‚¦ãƒ³ãƒˆ<span id="click">0</span></p>
      </section>
    </div>
    <div class="card-zone">
      <div class="card" draggable="true" id="card-5" ondragstart="drag(event)">
        5â™¥
      </div>
      <div class="card" draggable="true" id="card-8" ondragstart="drag(event)">
        8â™¦
      </div>
      <div class="card" draggable="true" id="card-10" ondragstart="drag(event)">
        10â™£
      </div>
      <div
        class="card"
        draggable="true"
        id="card-J"
        ondragstart="drag(event)"
        onclick="handleCardClick()"
      >
        Jâ™£
      </div>
      <div class="card" draggable="true" id="card-Q" ondragstart="drag(event)">
        Qâ™¦
      </div>
      <div class="card" draggable="true" id="card-K" ondragstart="drag(event)">
        Kâ™¥
      </div>
      <div class="card" draggable="true" id="card-A" ondragstart="drag(event)">
        Aâ™ 
      </div>

      <script>
        const answerChars = ["ã‚¿", "ãƒƒ", "ãƒ—"];
        const droppedFlags = [false, false, false];

        function allowDrop(ev) {
          ev.preventDefault();
        }

        function drag(ev) {
          ev.dataTransfer.setData("text", ev.target.id);
        }

        function dropHeart(ev, index) {
          ev.preventDefault();
          const data = ev.dataTransfer.getData("text");
          const card = document.getElementById(data);
          const heart = document.getElementById("heart" + index);

          if (card.id === "card-8" && !droppedFlags[index]) {
            droppedFlags[index] = true;
            heart.classList.add("break");

            /* ğŸ”Šå¤±æ‹éŸ³å†ç”Ÿ */
            brakeHeart();

            setTimeout(() => {
              const span = document.createElement("span");
              span.className = "reveal";
              span.textContent = answerChars[index];
              heart.appendChild(span);
            }, 600);

            checkAnswer();
          } else {
            document.getElementById("q3-result").textContent =
              "ãã®ã‚«ãƒ¼ãƒ‰ã§ã¯â™¡ã¯åˆ‡ã‚Œãªã„ã‚ˆã†ã â€¦";
          }
        }

        function checkAnswer() {
          if (droppedFlags.every((f) => f)) {
            document.getElementById("q3-result").textContent =
              "ç­”ãˆãŒè¦‹ãˆãŸã‚ˆã†ã ã­ã€‚ã¨ã“ã‚ã§å›ã¯å¤§è²§æ°‘ã‹ãªï¼Ÿãã‚Œã˜ã‚ƒãƒ¼å¤§å¯Œè±ªã®â€œå½¼â€ã«ãã®ï¼’æšã‚’æ¸¡ã•ãªã„ã¨(ç¬‘)";
          }
        }

        let droppedCards = new Set();
        function dropCard(event) {
          event.preventDefault();
          let cardId = event.dataTransfer.getData("text/plain");
          const magician = document.querySelector(".js_magician");
          magician.classList.add("is-active");

          if (cardId === "card-K" || cardId === "card-A") {
            droppedCards.add(cardId); // ã‚»ãƒƒãƒˆã«è¿½åŠ ï¼ˆé‡è¤‡ã—ãªã„ï¼‰

            // ãƒ‰ãƒ­ãƒƒãƒ—å…ˆã«è¡¨ç¤ºï¼ˆæ¼”å‡ºç”¨ï¼‰
            let card = document.getElementById(cardId);
            event.target.appendChild(card);

            // ä¸¡æ–¹ãã‚ã£ãŸã‚‰æ¬¡ã®å•é¡Œè¡¨ç¤º
            if (droppedCards.has("card-K") && droppedCards.has("card-A")) {
              document
                .querySelector(".js_final-question")
                .classList.toggle("is-active");
            }
          }
        }
      </script>
    </div>
    <script>
      function q4CheckAnswer() {
        const input = Number(document.getElementById("q4-answer").value);
        const result = document.getElementById("q4-result");

        if (input == q4AnswerValue) {
          const nextQuestionEl = document.querySelector(".js_final-question");
          if (nextQuestionEl.classList.contains("is-active")) {
            // è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹
            result.textContent =
              "ã“ã‚Œã§ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ãã‚ã£ãŸã€‚æ¬¡ã®æŒ‡ç¤ºã«ã—ãŸãŒã†ã®ã ã€‚";
          } else {
            // éè¡¨ç¤º
            result.textContent =
              "ã“ã‚Œã§ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ãã‚ã£ãŸã€‚ã€ã€ã€æ¬¡ã®æŒ‡ç¤ºãŒãªã„ã£ã¦ï¼Ÿä½•ã‹è¦‹è½ã¨ã—ã¦ã„ã‚‹ã‚“ã˜ã‚ƒãªã„ã‹ï¼Ÿ";
          }
        } else {
          result.textContent =
            "ç­”ãˆãŒé•ã†ã‚ˆã†ã â€¦è€³ã‚’æ¾„ã¾ã›ã‚‚ã†ä¸€åº¦éå»ã‚’æŒ¯ã‚Šè¿”ã‚‹ãŒã„ã„ã€‚";
          /* ğŸ”Šå¤±æ‹éŸ³å†ç”Ÿ */
          brakeHeart();
          /* ãƒŸã‚¹ã‚«ã‚¦ãƒ³ãƒˆ */
          addMistake();
        }
      }
    </script>
  </body>
</html>
